{% extends "base.html" %}
{% block title %}Create Account | PhysiHome{% endblock %}
{% block content %}
<section class="auth-card card">
  <header class="auth-header">
    <h1>Create your patient account</h1>
    <p>We will send a one-time code to your email for verification.</p>
  </header>

  {% if error %}
  <div class="alert error">{{ error }}</div>
  {% endif %}

  <form class="stack" method="post" action="/api/auth/signup" enctype="multipart/form-data">
    <div class="form-grid two-col">
      <label>
        First name
        <input
          type="text"
          name="first_name"
          placeholder="Your first name"
          autocomplete="given-name"
          required
        />
      </label>
      <label>
        Last name
        <input
          type="text"
          name="last_name"
          placeholder="Your last name"
          autocomplete="family-name"
          required
        />
      </label>
    </div>

    <div class="form-grid two-col">
      <label>
        Date of birth
        <div class="dob-input" data-dob-field>
          <input 
            type="date" 
            name="dob_backup"
            autocomplete="bday"
            required 
            pattern="\d{4}-\d{2}-\d{2}"
            title="YYYY-MM-DD format"
          />
          <input type="hidden" name="dob" data-dob-hidden />
          <div class="dob-text-entry">
            <input
              type="text"
              inputmode="numeric"
              placeholder="DD-MM-YYYY"
              aria-label="Type your date of birth as DD-MM-YYYY"
              data-dob-text
              name="dob_display"
              autocomplete="bday"
            />
            <small class="helper">Type the date (DD-MM-YYYY) or use the picker.</small>
          </div>
        </div>
      </label>
      <label>
        Contact number
        <input
          type="tel"
          name="phone"
          placeholder="10-digit number"
          autocomplete="tel"
          required
        />
      </label>
    </div>

    <div class="form-grid two-col">
      <label>
        Email address
        <input
          type="email"
          name="email"
          placeholder="you@family.in"
          autocomplete="email"
          required
        />
      </label>
      <label>
        Gender (optional)
        <select name="gender">
          <option value="">Prefer not to say</option>
          <option value="female">Female</option>
          <option value="male">Male</option>
          <option value="other">Other</option>
        </select>
      </label>
    </div>

    <label class="upload">
      Profile photo (optional)
      <input type="file" name="profile_photo" accept="image/*" autocomplete="off" />
    </label>

    <label>
      Password
      <div style="position:relative;">
        <input
          type="password"
          name="password"
          placeholder="Create a strong password"
          autocomplete="new-password"
          required
          minlength="8"
          pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}"
          title="Must be at least 8 characters and include upper, lower, number, and special character"
        />
        <button type="button" onclick="togglePassword(this.previousElementSibling)" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); background:none; border:none; font-size:1.2rem; cursor:pointer;">üëÅ</button>
      </div>
      <small class="helper">Use at least 8 characters including upper, lower, number, and symbol.</small>
    </label>
    <button class="btn primary" type="submit">Send OTP</button>
  </form>

  <p class="small">
    Already with us?
    <a href="/login">Login</a>
  </p>
  <p class="small">
    Are you a doctor?
    <a href="/signup/doctor">Go to doctor signup</a>
  </p>
</section>
{% endblock %}
