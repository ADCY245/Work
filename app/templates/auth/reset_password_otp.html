{% extends "base.html" %}
{% block title %}Reset Password | PhysiHome{% endblock %}
{% block content %}
<section class="auth-card card">
  <header class="auth-header">
    <h1>Reset password</h1>
    <p>We sent a one-time code to <strong>{{ email }}</strong>. Enter it to continue.</p>
  </header>

  {% if error %}
  <div class="alert error">{{ error }}</div>
  {% endif %}

  {% if success_message %}
  <div class="alert success">{{ success_message }}</div>
  {% endif %}

  {% if email_error %}
  <div class="alert warn">We could not send the OTP email. {{ email_error }}</div>
  {% endif %}

  {% if otp_debug %}
  <div class="alert info">
    Email delivery is delayed, but here is your reset code: <strong>{{ otp_debug }}</strong>.
  </div>
  {% endif %}

  <form class="stack" method="post" action="/api/auth/forgot-password/verify-otp">
    <input type="hidden" name="email" value="{{ email }}" />
    <label>
      Reset code
      <input
        type="text"
        name="otp"
        inputmode="numeric"
        pattern="\d{6}"
        maxlength="6"
        placeholder="6-digit code"
        required
      />
    </label>
    <button class="btn primary" type="submit">Verify</button>
  </form>

  <form class="stack" style="margin-top: 1rem" method="post" action="/api/auth/forgot-password">
    <input type="hidden" name="email" value="{{ email }}" />
    <button class="btn ghost" type="submit">Resend code</button>
  </form>

  <p class="small">
    Changed your mind?
    <a href="/login">Back to login</a>
  </p>
</section>
{% endblock %}
